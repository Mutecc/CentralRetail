<!DOCTYPE html>
<html lang="th">
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central Mutec</title>
    <link rel="icon" type="image/png" href="https://img5.pic.in.th/file/secure-sv1/Logo-IWF.png">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.20/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.20/dist/sweetalert2.all.min.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ฟังก์ชันสำหรับตรวจสอบ User Agent ของ In-App Browser
            function is_InAppBrowser() {
                const userAgent = navigator.userAgent || navigator.vendor || window.opera;
                return (
                    // เพิ่มการตรวจสอบสำหรับแอปฯ ยอดนิยมอื่นๆ
                    /FBAV|FBAN|LINE|Tiktok|Instagram|Twitter|Snapchat|Telegram|MicroMessenger|Pinterest|Reddit|Threads/i.test(userAgent) || 
                    // ตรวจสอบเพิ่มเติมสำหรับ iOS In-App Browser
                    (
                        /CriOS/.test(userAgent) && /Safari/.test(userAgent)
                    )
                );
            }

            const urlParams = new URLSearchParams(window.location.search);
            
            if (urlParams.has('openExternalBrowser')) {
                console.log("เปิดในเบราว์เซอร์ภายนอกแล้ว");
                return;
            }

            if (is_InAppBrowser()) {
                Swal.fire({
                    title: 'เปิดในเบราว์เซอร์หลัก',
                    text: 'เพื่อประสิทธิภาพสูงสุดในการใช้งาน กรุณาเปิดหน้าเว็บนี้ในเบราว์เซอร์หลัก (เช่น Chrome, Safari) ค่ะ',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'เปิดเบราว์เซอร์',
                    cancelButtonText: 'ยกเลิก',
                    allowOutsideClick: false,
                    reverseButtons: true
                }).then((result) => {
                    if (result.isConfirmed) {
                        const currentUrl = new URL(window.location.href);
                        currentUrl.searchParams.set('openExternalBrowser', '1');
                        
                        window.location.href = currentUrl.toString();
                    }
                });
            }
        });
    </script>
</head>
<body>
    <iframe style="width: 100%; height: 100vh;" scrolling="yes" src="https://script.google.com/macros/s/AKfycbwRxeAG9pE3SVv8KmycCj_My_TcV3kmbhiG00qRQVvkd52jGLCL9cRC9wIlnK8tLItf/exec" frameborder="0"></iframe>
</body>
</html>
